<!DOCTYPE html>
<html>
<head>
	<title>Friend Finder</title>

	<!-- Latest compiled and minified CSS & JS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">

</head>

<body>
<nav class="navbar navbar-default navbar-static-top">
  <div class="container pexel-logo-coupleBB">
  		<h1 class="text-center">Friend Finder</h1>

  </div>
</nav>

<div class="well"">
	<h2 class="text-left">Survey Questions:</h2>
	<div class="panel panel-info" id="survey">
	  	<div class="panel-heading">
	  		<h3 class="panel-title">1. I don't like yoga.</h3>
	  	</div>
  		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer1" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer1" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer1" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer1" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer1" value="5">5-Strongly Disagree
			</label>
		  </div>
	  	<div class="panel-heading">
	  		<h3 class="panel-title">2. I love my job.</h3>
	  	</div>
	  	<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer2" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer2" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer2" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer2" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer2" value="5">5-Strongly Disagree
			</label>
		</div>
		<div class="panel-heading">
		 	<h3 class="panel-title">3. My favorite sport is basketball.</h3>
		</div>
		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer3" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer3" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer3" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer3" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer3" value="5">5-Strongly Disagree
			</label>
	  	</div>
		<div class="panel-heading">
			<h3 class="panel-title">4. I don't like American Football.</h3>
		</div>
		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer4" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer4" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer4" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer4" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer4" value="5">5-Strongly Disagree
			</label>
		</div>
		<div class="panel-heading">
			<h3 class="panel-title">5. I go to at least 8 sporting events a year.</h3>
		</div>
		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer5" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer5" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer5" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer5" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer5" value="5">5-Strongly Disagree
			</label>
		</div>
		<div class="panel-heading">
	  		<h3 class="panel-title">6. A gym membership is useless.</h3>
		</div>
		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer6" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer6" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer6" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer6" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer6" value="5">5-Strongly Disagree
			</label>
		</div>
		<div class="panel-heading">
		  	<h3 class="panel-title">7. I enjoy visiting cities.</h3>
		</div>
		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer7" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer7" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer7" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer7" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer7" value="5">5-Strongly Disagree
			</label>
		</div>
		<div class="panel-heading">
			<h3 class="panel-title">8. I participate in 5K walk/run at least once a year.</h3>
		</div>
		<div class="panel-body">
					<label class="radio-inline">
				<input class="scores" type="radio" name="answer8" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer8" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer8" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer8" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer8" value="5">5-Strongly Disagree
			</label>
		</div>
		<div class="panel-heading">
			<h3 class="panel-title">9. I don't like going out to dinner on weekends.</h3>
		</div>
		<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer9" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer9" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer9" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer9" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer9" value="5">5-Strongly Disagree
			</label>
			</div>
			<div class="panel-heading">
				<h3 class="panel-title">10. I prefer caribbean beach vacations.</h3>
			</div>
			<div class="panel-body">
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer10" value="1">1-Strongly Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer10" value="2">2-Agree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer10" value="3">3-Undecided
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer10" value="4">4-Disagree
			</label>
			<label class="radio-inline">
				<input class="scores" type="radio" name="answer10" value="5">5-Strongly Disagree
			</label>
		</div>
	</div>
	<div class="form-group">
	<form>
		<label for="name">Name</label>
		<input type="text" class="form-control" placeholder="Name" id="name" >
		<label for="name">Photo Link</label>
		<input type="text" class="form-control" placeholder="photo" id="photo">
	</form>
	</div>
	<button type="submit" class="btn btn-primary submit">Submit</button>
</div>





<div class="container">
 <div class="alert alert-danger alert-dismissable">
    <a href="#" class="close alertbox" data-dismiss="alert" aria-label="close">Ã—</a>
    <!-- <strong>Danger!</strong> This alert box could indicate a dangerous or potentially negative action. -->
  </div>
 </div>

 <div id="postedFriend"></div>

<script type="text/javascript">

// On Click submit, jQuery grabs all of the fields then sends a post request to our api. the Api knows the route and runs the code. The code "saves" the data to the friend.js 

	$(".submit").on("click", function(event) {
		console.log(event);
	console.log('submit event');
	  event.preventDefault();

	  // Here we grab the form elements
	  	var newFriend = {
	        name: $("#name").val().trim(),
	        photo: $("#photo").val().trim(),
		    scores: [
		        	$('input[name="answer1"]:checked', '#survey').val(),
		        	$('input[name="answer2"]:checked', '#survey').val(),
		        	$('input[name="answer3"]:checked', '#survey').val(),
		        	$('input[name="answer4"]:checked', '#survey').val(),
		        	$('input[name="answer5"]:checked', '#survey').val(),
		        	$('input[name="answer6"]:checked', '#survey').val(),
		        	$('input[name="answer7"]:checked', '#survey').val(),
		        	$('input[name="answer8"]:checked', '#survey').val(),
		        	$('input[name="answer9"]:checked', '#survey').val(),
		        	$('input[name="answer10"]:checked', '#survey').val()
		        ]
	      };

	  	console.log(newFriend);
	  	var validName = newFriend.name.length;
	  	var validPhotoLink = newFriend.photo.length;
	  	var scoresString = newFriend.scores.toString();
	  	var validScores = scoresString.length;

		// This line is the magic. It"s very similar to the standard ajax function we used.
		// Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
		// The callback is the response of the server. In our case, we set up code in api-routes that "returns" true or false
		
		// validate that all fields are entered then post
		if (validScores < 19){
			console.log('validScores < 19');
			$(".alertbox").text("Invalid Survey: Please answer all 10 questions.")
		}
		if (validName < 2){
			$(".alertbox").text("Invalid Name: Please enter a name.")
			console.log('validNmae < 2 charactors')
		}
		if (validPhotoLink < 6){
			$(".alertbox").text("Invalid Photo Link: Please a Photo Link.")
			console.log('validPhotoLink < 6')
		}
		

		if ((validScores > 18) && (validName > 1) && (validPhotoLink > 5)){
			$(".alertbox").text("Success.")
			$.post("/api/friends", newFriend, function(data) {
				console.log('data', data);
				console.log('newFriend', newFriend);
		           
		          // If a table is available... tell user they are booked.
		        if (data) {
		          	runFriendQuery(newFriend);
		        	alert("You are officially on the Friend Finder DB");
		        	// toastr.info('You have been added to Friend Finder DB')

		        }
				else {			
		        	alert("Sorry we could not add you to our Friend Finder DB");
		        }

				// Clear the form when submitting
				// runFriendQuery();
				$("#name").val("");
				$("#photo").val("")
				$(".scores").val([""]);
			}); //end post
		}; //if
	}); //submit function

	   // In this code, jQuery is used to "download" the data from our server
	    // We then dynamically display this content in our table. This is very similar to the group projects you just completed.
	    // It's also very similar to the NYT search application. In fact, I copied a ton of code from there.

	    function runFriendQuery(findFriend) {
	    	console.log(findFriend);

			console.log('runFriendQuery');
			var currentURL = window.location.origin;

			      // The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
			$.ajax({ url: currentURL + "/api/friends", method: "GET" })
		     	.done(function(friends) {

		        // Here we are logging the URL so we have access to it for troubleshooting
		        console.log("------------------------------------");
		        console.log("URL: " + currentURL + "/api/friends");
		        console.log("------------------------------------");

		        // Here we then log friend data to displays as an object.
		        console.log('friends-----------', friends);
		        console.log("------------------------------------");


		        // Loop through api/friends to display all friends and check which is compatible.
		        for (var i = 0; i < friends.length; i++) {
					console.log(friends.length)

					// var friendDiv = $("<div>");
					// console.log(friendDiv);
					// var a = friendDiv.addClass("well");
					// console.log(a);
					// var b = friendDiv.attr("id", "postedFriend-" + i + 1);
					// console.log(b);
					$("#postedFriend").append("<h2><span class='label label-primary'>" + friends[i].name + "</span></h2><img src='" + friends[i].photo + "' alt='Friend Photo' style=width:304px;height:228px;>");
					// check for compatibility while running through list
					// for (var j = 0; j < friend.scores.length; j++) {
						
					// }


				}
	      	}); //ajax 
	    }; //function
	// runFriendQuery();
	
	</script>

</body>
</html>